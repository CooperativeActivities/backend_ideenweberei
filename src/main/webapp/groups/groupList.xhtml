<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/WEB-INF/templates/main.xhtml">
    <ui:define name="content">
        <h:form id="form">
            <p:outputPanel class="row" id="itemList">
                <div class="col-xs-12">
                    <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true"/>
                    <div class="form-group">
                        <p:commandButton class="btn btn-primary"
                                         value="Create"
                                         icon="fa fa-pencil"
                                         update="form:itemEditDialog"
                                         oncomplete="PF('itemEditDialog').show()">
                            <f:setPropertyActionListener value="#{groupDetailController.create()}"
                                                         target="#{groupDetailController.group}"/>
                        </p:commandButton>
                    </div>
                </div>
                <div class="col-xs-12">
                    <p:dataTable var="group" value="#{groupListController.groupList}"
                                 tableStyleClass="table table-striped"
                                 styleClass="table-responsive" id="itemTable">
                        <p:column headerText="Name" sortBy="#{group.name}" filterBy="#{group.name}"
                                  filterMatchMode="contains">
                            <h:outputText value="#{group.name}"/>
                        </p:column>
                        <p:column style="text-align: center">
                            <p:commandButton class="btn btn-primary"
                                             value="Edit"
                                             icon="fa fa-pencil"
                                             update="form:itemEditDialog"
                                             oncomplete="PF('itemEditDialog').show()">
                                <f:setPropertyActionListener value="#{group}"
                                                             target="#{groupDetailController.group}"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                    <!-- ........................................................................................... -->
                    <p:dialog header="Group"
                              widgetVar="itemEditDialog" id="itemEditDialog" modal="true" showEffect="fade"
                              hideEffect="fade" resizable="true">
                        <p:outputPanel class="container" id="itemDetail"
                                       rendered="#{not empty groupDetailController.group}">
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="panel panel-default ">
                                        <div class="panel-heading">
                                            <p:commandButton class="btn btn-primary"
                                                             value="Save"
                                                             icon="fa fa-floppy-o"
                                                             update="form:itemTable form:itemDetail"
                                                             action="#{groupDetailController.save()}">
                                            </p:commandButton>
                                            <p:commandButton class="btn btn-primary"
                                                             value="Save and Close"
                                                             icon="fa fa-floppy-o"
                                                             update="form:itemTable"
                                                             action="#{groupDetailController.save()}"
                                                             oncomplete="PF('itemEditDialog').hide()">
                                            </p:commandButton>
                                            <p:commandButton class="btn btn-primary"
                                                             value="Delete"
                                                             immediate="true"
                                                             icon="fa fa-trash-o"
                                                             update="form:itemTable"
                                                             action="#{groupDetailController.delete()}"
                                                             oncomplete="PF('itemEditDialog').hide()"
                                                             rendered="#{not groupDetailController.group.isNew()}">
                                            </p:commandButton>
                                            <p:commandButton class="btn btn-primary"
                                                             value="Close"
                                                             icon="fa fa-floppy-o"
                                                             update="form:itemTable"
                                                             oncomplete="PF('itemEditDialog').hide()">
                                            </p:commandButton>
                                        </div>
                                        <div class="panel-body form-inline">
                                            <div class="form-group">
                                                <h:outputLabel for="itemName" value="Name:"/>
                                                <div class="input-group">
                                                    <div class="input-group-addon">
                                                        <i class="fa fa-users"/>
                                                    </div>
                                                    <p:inputText id="itemName" class="form-control"
                                                                 value="#{groupDetailController.group.name}"
                                                                 required="true" requiredMessage="Name is missing."/>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <h:outputLabel for="itemLimit" value="Limit:"/>
                                                <div class="input-group">
                                                    <div class="input-group-addon">
                                                        <i class="fa fa-hashtag"/>
                                                    </div>
                                                    <p:inputText id="itemLimit" class="form-control"
                                                                 value="#{groupDetailController.group.maxEnrols}"
                                                                 size="4"
                                                                 required="true" requiredMessage="Limit is missing.">
                                                        <f:convertNumber integerOnly="true"/>
                                                    </p:inputText>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <h:outputLabel for="itemDesc" value="Beschreibung:"/>
                                                <div class="input-group">
                                                    <div class="input-group-addon">
                                                        <i class="fa fa-info"/>
                                                    </div>
                                                    <p:inputTextarea id="itemDesc" rows="10" cols="40"
                                                                     value="#{groupDetailController.group.description}"
                                                                     required="true"
                                                                     requiredMessage="Desc is missing."/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </p:outputPanel>
                    </p:dialog>
                </div>
            </p:outputPanel>
        </h:form>
    </ui:define>
</ui:composition>